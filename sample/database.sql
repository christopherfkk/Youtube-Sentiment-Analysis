-- d_videos table definition

CREATE TABLE d_videos (
    id int NOT NULL AUTO_INCREMENT,
    video_id varchar(255),
    name varchar (255),
    views int,
    likes int,
    comments int,
    date date,
    PRIMARY KEY (id), 
    UNIQUE (video_id))

-- d_comments table definition

CREATE TABLE d_comments (
    id int NOT NULL AUTO_INCREMENT,
    video_id int,
    comment_id varchar(255),
    comment_raw varchar(5000),
    comment_clean varchar(5000),
    polarity decimal(5,3),
    sentiment varchar(255),
    PRIMARY KEY (id),
    FOREIGN KEY (video_id) REFERENCES d_videos (id),
    UNIQUE (comment_id))
        
-- upsert into d_videos

INSERT INTO testdatabase.d_videos(video_id, name, views, likes, comments, date) VALUES {formatted_values} ON DUPLICATE KEY UPDATE id=id, name=values(name), views=values(views), comments=values(comments), likes=values(likes), date=values(date)
    
-- upsert into d_comments with foreign key in d_videos

INSERT INTO testdatabase.d_comments (video_id, comment_id, comment_raw, comment_clean, polarity, sentiment) VALUES { formatted_values } ON DUPLICATE KEY UPDATE comment_raw = values(comment_raw), comment_clean = values(comment_clean), polarity = values(polarity), sentiment = values(sentiment)


-- problem

INSERT INTO testdatabase.d_comments (video_id, comment_id, comment_raw, comment_clean, polarity, sentiment) VALUES ((SELECT id FROM testdatabase.d_videos WHERE video_id = \'ycPr5-27vSI\'), \'UgxkKRIkPxPEW-2HbQF4AaABAg\', \'Watching Elon talk reminds me of my dad. He was an engineer, his mind was always developing things. He created <a href="http://s.a.e.co/">S.A.E.CO</a> early on it was steam age equipment company, in the later years it became 
Space Age Equipment Company. To me his mind was one of a kind. The only way he could stop was to get high this interview makes so much more sense to me now. The last few years he told me to keep an eye on Iran. He passed away in 2018 and now Iran is fucking nuclear due to Biden.\', \'watching elon talk reminds dad . engineer , mind always developing things . created < href= \'\' http : //s.a.e.co/ \'\' > s.a.e.co < /a > early steam age equipment company , later years became space age equipment company . mind one kind . way could stop get high interview makes much sense . last years told keep eye iran . passed away 2018 iran fucking nuclear due biden .\', 0.4939, \'pos\'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgxIb05yO3CjX5mgqG14AaABAg', 'Fantastic questions, awesome answers<br>The way Rogen drives the iview is masterfully achieved with Musk gracefully going along with intrinsic points of view', 'fantastic questions , awesome answers < br > way rogen drives iview masterfully achieved musk gracefully going along intrinsic points view', 0.9022, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugx603aNHAr2eAZcYsN4AaABAg', 'Protect this man at all costs', 'protect man costs', 0.3818, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgwxRAsqPBf6JYFDXmF4AaABAg', 'Damn, am I happy that Elon is on our (good) side in the good vs evil fight. Imagine if he was the villain of the story üò≥. Much love, Elon üíó', 'damn , happy elon ( good ) side good vs evil fight . imagine villain story . much love , elon', 0.1027, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugylj4Z-hbj95_9nt-Z4AaABAg', 'Before Elon says something his mind is trying to predict every possible outcome for each sentence he wants to use.', 'elon says something mind trying predict every possible outcome sentence wants use .', 0.0772, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = \'ycPr5-27vSI\'), \'UgxYvg29AY0oGTCNwax4AaABAg\', \'<a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=2h16m47s">2:16:47</a><br>The emotional depth of this moment.. his response shows the negative side of being ‚Äúgifted‚Äù\', \'< href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp ; t=2h16m47s \'\' > 2:16:47 < /a > < br > emotional depth moment .. response shows negative side ‚Äú gifted ‚Äù\', -0.4767, \'neg\'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugxi2lvnbPLPlxa6i0J4AaABAg', 'Two ordinary individuals doing great and amazing things üëå', 'two ordinary individuals great amazing things', 0.836, 'pos'), ((SELECT id FROM 
testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugyvzku09yCAM2Yjm2l4AaABAg', '‚ÄúWe‚Äôre in a simulation because we exist.‚Äù - Elon Musk<br><br>So doesn‚Äôt that mean there is a Creator(s)?', '‚Äú ‚Äô simulation exist. ‚Äù - elon musk < br > < br > ‚Äô mean creator ( ) ?', 0.0, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 
'ycPr5-27vSI'), 'UgyVXD7BO-n9XlUSeQh4AaABAg', 'I would love to see a podcast with Joe, Elon and Bob Lazar just sit and talk about all this.', 'would love see podcast joe , elon bob lazar sit talk .', 0.6369, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgxduqZD5kuxhSYyLWd4AaABAg', 'Just listening to him makes me feel like I&#39;m 1 IQ point away from being a lettuce .', 'listening makes feel like & # 39 ; 1 iq point away lettuce .', 0.3612, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgzdemGqGrzA20cdDS54AaABAg', 'That&#39;s weird they didn&#39;t have to provide blueprints of what they were intending on building. As a contractor I always have to.<br><br>To answer Joe&#39;s question about who else could 
get the clearance that Elon musk does. Just name any inventor throughout history.<br><br>I also find it funny that Joe thinks it takes a lot of time to do all these things. Sure it takes time but it doesn&#39;t take any more time than it takes anyone else to do their job. I could design a flamethrower in a week or less. So for Elon to be able to do things with entire teams of engineers it&#39;s not out of the normal. Since he&#39;s not doing all the work himself. He has plenty of time to do other things and get sleep.', '& # 39 ; weird & # 39 ; provide blueprints intending building . contractor always to. < br > < br > answer joe & # 39 ; question else could get clearance elon musk . name inventor throughout history. < br > < br > also find funny joe thinks takes lot time things . sure takes time & # 39 ; take time takes anyone else job . could design flamethrower week less . elon able things entire teams engineers & # 39 ; normal . since & # 39 ; work . plenty time things get sleep .', 0.5423, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgwQHNlBNo1EOKtByXt4AaABAg', 
'I‚Äôd love to drive a Tesla car-even at 84. Loved this video.', '‚Äô love drive tesla car-even 84. loved video .', 
0.8442, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = \'ycPr5-27vSI\'), \'UgzjleM4ccvtq1_yDsV4AaABAg\', \'<a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=5m55s">5:55</a> Son unos de los <a href="http://topgirls.uno/">Topgirls.Uno</a><br><br><a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=15m55s">15:55</a> Sun: &#39;&#39;Hotter&#39;&#39;<br><a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=15m55s">15:55</a> Hopi: &#39;&#39;Sweeter&#39;&#39;<br><a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=15m55s">15:55</a> Joonie: &#39;&#39;Cooler&#39;&#39;<br><a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=15m55s">15:55</a> Yoongi: &#39;&#39;Butter&#39;&#39;<br><br><a href="https://www.youtube.com/watch?v=ycPr5-27vSI&amp;t=15m55s">15:55</a> Son unos de los mejores conciertos ,<br>, no puede ir pero de tan solo verlos desde 
pantalla, se que estuvo sorprendente...\', \'< href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp 
; t=5m55s \'\' > 5:55 < /a > son unos de los < href= \'\' http : //topgirls.uno/ \'\' > topgirls.uno < /a > < br > < br > < href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp ; t=15m55s \'\' > 15:55 < /a > sun 
: & # 39 ; & # 39 ; hotter & # 39 ; & # 39 ; < br > < href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp ; t=15m55s \'\' > 15:55 < /a > hopi : & # 39 ; & # 39 ; sweeter & # 39 ; & # 39 ; < br > < href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp ; t=15m55s \'\' > 15:55 < /a > joonie : & # 39 ; & # 39 ; cooler & # 39 ; & # 39 ; < br > < href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp ; t=15m55s \'\' 
> 15:55 < /a > yoongi : & # 39 ; & # 39 ; butter & # 39 ; & # 39 ; < br > < br > < href= \'\' https : //www.youtube.com/watch ? v=ycpr5-27vsi & amp ; t=15m55s \'\' > 15:55 < /a > son unos de los mejores conciertos , < br > , puede ir pero de tan solo verlos desde pantalla , se que estuvo sorprendente ...\', 0.0, \'neg\'), ((SELECT id 
FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugw8ppbaHl8c6Wz6-D94AaABAg', 'Listening to Elon talk about AI and the future is like  watching Joe Rogan interview Doctor Manhattan.', 'listening elon talk ai future like watching joe rogan interview doctor manhattan .', 0.3612, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugw_VVdUgq9ehXUpWkR4AaABAg', 'I love how he does that weird sort of nod after he states his opinion or argument, it‚Äôs almost like he‚Äôs agreeing with what his brain has said', 'love weird sort nod states opinion argument , ‚Äô almost like ‚Äô agreeing brain said', 0.6518, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugz_eo-WLNqRBum_WKJ4AaABAg', 'Joe...this was 3 years ago....can 
you have another interview to see what he&#39;s up to now??? I can listen to you guys all day and all night!!!', 'joe ... 3 years ago .... another interview see & # 39 ; ? ? ? listen guys day night ! ! !', 0.0, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgznWya6qEvFxgHIaoZ4AaABAg', 'Time to get Elon back again! So much has changed.', 'time get elon back ! much changed .', 0.0, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgxWINEsOBMqDOiUKX94AaABAg', 'I really like this dude! Insanely smart and still open minded enough to hit the blunt!!', 'really like dude ! insanely smart still open minded 
enough hit blunt ! !', 0.7483, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugz6C5loQHy6vTm9poZ4AaABAg', 'Elon, one cool nerd. Great interview. Thanks! Love is all ya need', 'elon , one cool nerd . great interview . thanks ! love ya need', 0.9117, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgzPzp5pJkcHL5zGB7J4AaABAg', '&quot;I wanna be optimistic and wrong, rather than pessimistic and right.&quot;<br>That hit me hard.', '& quot ; wan na optimistic wrong , rather pessimistic right. 
& quot ; < br > hit hard .', -0.5719, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgxLtcRxZ9KNMHvcc7d4AaABAg', 'Elon is probably the most honest, intelligent engineer/scientist/Biologist 
/astronaut enthusiast guy we don&#39;t give enough or any credit to. Hes our century genius unicorn, maybe we need to start listening.', 'elon probably honest , intelligent engineer/scientist/biologist /astronaut enthusiast 
guy & # 39 ; give enough credit . hes century genius unicorn , maybe need start listening .', 0.886, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgxL0gO1InHSh6hJrhd4AaABAg', 'Joe is so confused and stunned by Elon. It is unquestionable that Elon is on some different level. He‚Äôs so damn interesting 
to me', 'joe confused stunned elon . unquestionable elon different level . ‚Äô damn interesting', -0.4019, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'UgzEN-_alssXdUAw1B14AaABAg', 'Elon is 
the hella cool man I would love to have a conversation about time travel with him', 'elon hella cool man would love conversation time travel', 0.7778, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugxh7hIJD9XKwqqRAgh4AaABAg', '‚ÄúIf you were to explain it to someone who has no idea what your talking about‚Äù joe got a way with words', '‚Äú explain someone idea talking ‚Äù joe got way words', 0.0, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugyp5GcXu7caSm7DCr94AaABAg', 'Elon is such a down to Mars guy... üòè', 'elon mars guy ...', 0.0, 'neg'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugz0LAJm-0Z_ofZcjm94AaABAg', 'Hands down my favorite currently alive billionaire inventor!', 'hands favorite currently alive billionaire inventor !', 0.7088, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE 
video_id = 'ycPr5-27vSI'), 'UgwQ94-2tgEM4HL6WWR4AaABAg', 'I am so happy Elon got to hang out be himself and relax üòå I thin ke needed it like he said it hurts his brain and his heart to work this much', 'happy elon got hang 
relax thin ke needed like said hurts brain heart work much', 0.7184, 'pos'), ((SELECT id FROM testdatabase.d_videos WHERE video_id = 'ycPr5-27vSI'), 'Ugw9BODGjtqiNggFJFh4AaABAg', 'This man&#39;s philosophy is phenomenal as he says it it will all come true', 'man & # 39 ; philosophy phenomenal says come true', 0.4215, 'pos')
